# ---------------------------------------------------------------------------
# 1.py
# Created on: Thu Aug 01 2013 03:22:16 PM
#   (generated by ArcGIS/ModelBuilder)
# ---------------------------------------------------------------------------

# Import system modules
import sys, string, os, arcgisscripting

# Create the Geoprocessor object
gp = arcgisscripting.create()

# Load required toolboxes...
gp.AddToolbox("C:/Program Files/ArcGIS/ArcToolbox/Toolboxes/Conversion Tools.tbx")
gp.AddToolbox("C:/Program Files/ArcGIS/ArcToolbox/Toolboxes/Data Management Tools.tbx")


# Local variables...
tmp = "C:\\working\\code\\TRAIS\\tmp1"
TRAIS_gdb = tmp + "\\TRAIS.gdb"
Facilities_txt = tmp + "\\Facilities.txt"
Substances_txt = tmp + "\\Substances.txt"
substance_codes_output_txt = tmp + "\\substance_codes_output.txt"

Facilities_NAD83 = TRAIS_gdb + "\\Facilities_NAD83"
Substances_NAD83 = TRAIS_gdb + "\\Substances_NAD83"
Substances_Code_NAD83 = TRAIS_gdb + "\\Substances_Code_NAD83"

Facilities = TRAIS_gdb + "\\Facilities"
Substances = TRAIS_gdb + "\\Substances"
Substances_Code = TRAIS_gdb + "\\Substances_Code"

Facilities_Layer = "Facilities_Layer"
Substances_Layer = "Substances_Layer"
substance_codes_output_Layer = "substance_codes_output_Layer"


# Process: Make XY Event Layer...
gp.MakeXYEventLayer_management(Facilities_txt, "longitude", "latitude", Facilities_Layer, "GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]];-400 -400 1000000000;0 1;0 1;8.98315284119521E-09;0.001;0.001;IsHighPrecision")

# Process: Create File GDB...
gp.CreateFileGDB_management(tmp, "TRAIS")

# Process: Feature Class to Feature Class...
gp.FeatureClassToFeatureClass_conversion(Facilities_Layer, TRAIS_gdb, "Facilities_NAD83", "", "ID 'ID' true true false 4 Long 0 10 ,First,#," + tmp + "\\Facilities.txt,ID,-1,-1;Latitude 'Latitude' true true false 8 Double 0 0 ,First,#," + tmp + "\\Facilities.txt,Latitude,-1,-1;Longitude 'Longitude' true true false 8 Double 0 0 ,First,#," + tmp + "\\Facilities.txt,Longitude,-1,-1;FacilityID 'FacilityID' true true false 4 Long 0 10 ,First,#," + tmp + "\\Facilities.txt,FacilityID,-1,-1;FacilityName 'FacilityName' true true false 255 Text 0 0 ,First,#," + tmp + "\\Facilities.txt,FacilityName,-1,-1;Address 'Address' true true false 255 Text 0 0 ,First,#," + tmp + "\\Facilities.txt,Address,-1,-1;OrganizationName 'OrganizationName' true true false 255 Text 0 0 ,First,#," + tmp + "\\Facilities.txt,OrganizationName,-1,-1;NPRI_ID 'NPRI_ID' true true false 255 Text 0 0 ,First,#," + tmp + "\\Facilities.txt,NPRI_ID,-1,-1;Sector 'Sector' true true false 4 Long 0 10 ,First,#," + tmp + "\\Facilities.txt,Sector,-1,-1;SectorDesc 'SectorDesc' true true false 255 Text 0 0 ,First,#," + tmp + "\\Facilities.txt,SectorDesc,-1,-1;NUMsubst 'NUMsubst' true true false 4 Long 0 10 ,First,#," + tmp + "\\Facilities.txt,NUMsubst,-1,-1;Substance_List 'Substance_List' true true false 255 Text 0 0 ,First,#," + tmp + "\\Facilities.txt,Substance_List,-1,-1", "")

# Process: Project...
gp.Project_management(Facilities_NAD83, Facilities, "PROJCS['WGS_1984_Web_Mercator_Auxiliary_Sphere',GEOGCS['GCS_WGS_1984',DATUM['D_WGS_1984',SPHEROID['WGS_1984',6378137.0,298.257223563]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]],PROJECTION['Mercator_Auxiliary_Sphere'],PARAMETER['False_Easting',0.0],PARAMETER['False_Northing',0.0],PARAMETER['Central_Meridian',0.0],PARAMETER['Standard_Parallel_1',0.0],PARAMETER['Auxiliary_Sphere_Type',0.0],UNIT['Meter',1.0]]", "NAD_1983_To_WGS_1984_5", "GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]]")

# Remove Facilities_NAD83
gp.Delete_management(Facilities_NAD83, "FeatureClass")

# Process: Make XY Event Layer (2)...
gp.MakeXYEventLayer_management(Substances_txt, "longitude", "latitude", Substances_Layer, "GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]];-400 -400 1000000000;0 1;0 1;8.98315284119521E-09;0.001;0.001;IsHighPrecision")

# Process: Feature Class to Feature Class (2)...
gp.FeatureClassToFeatureClass_conversion(Substances_Layer, TRAIS_gdb, "Substances_NAD83", "", "ID 'ID' true true false 4 Long 0 10 ,First,#," + tmp + "\\Substances.txt,ID,-1,-1;Latitude 'Latitude' true true false 8 Double 0 0 ,First,#," + tmp + "\\Substances.txt,Latitude,-1,-1;Longitude 'Longitude' true true false 8 Double 0 0 ,First,#," + tmp + "\\Substances.txt,Longitude,-1,-1;FacilityName 'FacilityName' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,FacilityName,-1,-1;Address 'Address' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,Address,-1,-1;OrganizationName 'OrganizationName' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,OrganizationName,-1,-1;NPRI_ID 'NPRI_ID' true true false 4 Long 0 10 ,First,#," + tmp + "\\Substances.txt,NPRI_ID,-1,-1;Sector 'Sector' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,Sector,-1,-1;Contact 'Contact' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,Contact,-1,-1;Phone 'Phone' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,Phone,-1,-1;Email 'Email' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,Email,-1,-1;HREmploy 'HREmploy' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,HREmploy,-1,-1;SubstanceName 'SubstanceName' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,SubstanceName,-1,-1;Units 'Units' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,Units,-1,-1;Use 'Use' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,Use,-1,-1;Creation 'Creation' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,Creation,-1,-1;Contained 'Contained' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,Contained,-1,-1;ReleasestoAir 'ReleasestoAir' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,ReleasestoAir,-1,-1;ReleasestoWater 'ReleasestoWater' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,ReleasestoWater,-1,-1;ReleasestoLand 'ReleasestoLand' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,ReleasestoLand,-1,-1;DisposalOnSite 'DisposalOnSite' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,DisposalOnSite,-1,-1;DisposalOffSite 'DisposalOffSite' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,DisposalOffSite,-1,-1;RecycleOffSite 'RecycleOffSite' true true false 255 Text 0 0 ,First,#," + tmp + "\\Substances.txt,RecycleOffSite,-1,-1", "")

# Process: Project (2)...
gp.Project_management(Substances_NAD83, Substances, "PROJCS['WGS_1984_Web_Mercator_Auxiliary_Sphere',GEOGCS['GCS_WGS_1984',DATUM['D_WGS_1984',SPHEROID['WGS_1984',6378137.0,298.257223563]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]],PROJECTION['Mercator_Auxiliary_Sphere'],PARAMETER['False_Easting',0.0],PARAMETER['False_Northing',0.0],PARAMETER['Central_Meridian',0.0],PARAMETER['Standard_Parallel_1',0.0],PARAMETER['Auxiliary_Sphere_Type',0.0],UNIT['Meter',1.0]]", "NAD_1983_To_WGS_1984_5", "GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]]")

# Remove Substances_NAD83
gp.Delete_management(Substances_NAD83, "FeatureClass")

# Process: Make XY Event Layer (3)...
gp.MakeXYEventLayer_management(substance_codes_output_txt, "longitude", "latitude", substance_codes_output_Layer, "GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]];-400 -400 1000000000;0 1;0 1;8.98315284119521E-09;0.001;0.001;IsHighPrecision")

# Process: Feature Class to Feature Class (3)...
gp.FeatureClassToFeatureClass_conversion(substance_codes_output_Layer, TRAIS_gdb, "Substances_Code_NAD83", "", "Latitude 'Latitude' true true false 8 Double 0 0 ,First,#," + tmp + "\\substance_codes_output.txt,Latitude,-1,-1;Longitude 'Longitude' true true false 8 Double 0 0 ,First,#," + tmp + "\\substance_codes_output.txt,Longitude,-1,-1;CODE 'CODE' true true false 255 Text 0 0 ,First,#," + tmp + "\\substance_codes_output.txt,CODE,-1,-1;SUBSTANCE_EN 'SUBSTANCE_EN' true true false 255 Text 0 0 ,First,#," + tmp + "\\substance_codes_output.txt,SUBSTANCE_EN,-1,-1;SUBSTANCE_FR 'SUBSTANCE_FR' true true false 255 Text 0 0 ,First,#," + tmp + "\\substance_codes_output.txt,SUBSTANCE_FR,-1,-1;CAS 'CAS' true true false 255 Text 0 0 ,First,#," + tmp + "\\substance_codes_output.txt,CAS,-1,-1", "")

# Process: Project (3)...
gp.Project_management(Substances_Code_NAD83, Substances_Code, "PROJCS['WGS_1984_Web_Mercator_Auxiliary_Sphere',GEOGCS['GCS_WGS_1984',DATUM['D_WGS_1984',SPHEROID['WGS_1984',6378137.0,298.257223563]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]],PROJECTION['Mercator_Auxiliary_Sphere'],PARAMETER['False_Easting',0.0],PARAMETER['False_Northing',0.0],PARAMETER['Central_Meridian',0.0],PARAMETER['Standard_Parallel_1',0.0],PARAMETER['Auxiliary_Sphere_Type',0.0],UNIT['Meter',1.0]]", "NAD_1983_To_WGS_1984_5", "GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]]")

# Remove Substances_NAD83
gp.Delete_management(Substances_Code_NAD83, "FeatureClass")
